#!/bin/bash
# Tailscale Statusループスクリプト (ちらつき対策版)

# ループ開始前の案内
echo "------------------------------------------------------------"
echo "Tailscaleのステータスを 2秒おきに更新するぞ。"
echo "止めたければ Ctrl+C を押すがよい。"
echo "------------------------------------------------------------"
sleep 2

# 初回は画面をクリアするのじゃ
clear

# ステータス表示ループ (ちらつき対策版)
su -c "
while true; do
    # カーソルをホームポジション(左上)に移動させるのじゃ (ANSIエスケープシーケンス使用)
    printf '\033[H'
    
    # 時刻とタイトルを表示
    echo \"[\$(date +'%Y-%m-%d %H:%M:%S')] Tailscale Status\"
    echo \"========================================\"
    
    # tailscale statusを実行するのじゃ
    tailscale status
    
    echo \"========================================\"
    # 前の表示が残らないように、余分な行をクリア (ANSIエスケープシーケンス使用)
    for i in {1..10}; do
        printf '\033[K\n'
    done
    
    sleep 2
done
"
